<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
   xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
   xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
   xmlns:strings="clr-namespace:TwentyFortyEight.Maui.Resources.Strings"
   xmlns:vm="clr-namespace:TwentyFortyEight.ViewModels;assembly=TwentyFortyEight.ViewModels"
   x:Class="TwentyFortyEight.Maui.SettingsPage"
   x:DataType="vm:SettingsViewModel"
   Title="{x:Static strings:AppStrings.SettingsPageTitle}"
   Background="{AppThemeBinding Light={StaticResource PageBackgroundLight}, Dark={StaticResource PageBackgroundDark}}">

   <ScrollView Padding="16">
      <VerticalStackLayout Spacing="28">

         <!-- Animations Section -->
         <VerticalStackLayout Spacing="8">
            <Label x:Name="AnimationsSectionLabel"
               Text="{x:Static strings:AppStrings.AnimationsSection}"
               FontSize="13"
               TextColor="{AppThemeBinding Light={StaticResource NativeTextTertiaryLight}, Dark={StaticResource NativeTextTertiaryDark}}"
               Margin="16,0,0,0" />
            
            <Border x:Name="AnimationsSectionBorder"
               Background="{AppThemeBinding Light={StaticResource NativeSettingsCellBackgroundLight}, Dark={StaticResource NativeSettingsCellBackgroundDark}}"
               Stroke="Transparent">
               <Border.StrokeShape>
                  <RoundRectangle CornerRadius="{StaticResource NativeCardCornerRadius}" />
               </Border.StrokeShape>
               <VerticalStackLayout Spacing="0">

                  <!-- Enable Animations Toggle -->
                  <Grid x:Name="AnimationsToggleGrid"
                        ColumnDefinitions="*,Auto"
                        ColumnSpacing="16"
                        Padding="16,12">
                     <Label x:Name="EnableAnimationsLabel"
                        Grid.Column="0"
                        Text="{x:Static strings:AppStrings.EnableAnimations}"
                        FontSize="17"
                        TextColor="{AppThemeBinding Light={StaticResource NativeTextPrimaryLight}, Dark={StaticResource NativeTextPrimaryDark}}"
                        VerticalOptions="Center" />
                     <Switch x:Name="AnimationsEnabledSwitch"
                        AutomationId="AnimationsEnabledSwitch"
                        Grid.Column="1"
                        IsToggled="{Binding AnimationsEnabled}"
                        OnColor="{AppThemeBinding Light={StaticResource NativeAccentLight}, Dark={StaticResource NativeAccentDark}}"
                        ThumbColor="White"
                        VerticalOptions="Center"
                        SemanticProperties.Description="{x:Static strings:AppStrings.EnableAnimations}"
                        SemanticProperties.Hint="{x:Static strings:AppStrings.EnableAnimationsHint}" />
                  </Grid>
                  
                  <!-- Separator -->
                  <BoxView HeightRequest="0.5"
                           Color="{AppThemeBinding Light={StaticResource Gray300}, Dark={StaticResource Gray600}}"
                           IsVisible="{Binding AnimationsEnabled}"
                           Margin="16,0" />

                  <!-- Animation Speed Slider -->
                  <VerticalStackLayout Spacing="8" IsVisible="{Binding AnimationsEnabled}" Padding="16,12">
                     <Label
                        Text="{x:Static strings:AppStrings.AnimationSpeed}"
                        FontSize="17"
                        TextColor="{AppThemeBinding Light={StaticResource NativeTextPrimaryLight}, Dark={StaticResource NativeTextPrimaryDark}}" />
                     
                     <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="12" Margin="0,4,0,0">
                        <Label
                           Grid.Column="0"
                           Text="{x:Static strings:AppStrings.AnimationSpeedSlow}"
                           FontSize="13"
                           TextColor="{AppThemeBinding Light={StaticResource NativeTextSecondaryLight}, Dark={StaticResource NativeTextSecondaryDark}}"
                           VerticalOptions="Center" />
                        <Slider
                           AutomationId="AnimationSpeedSlider"
                           Grid.Column="1"
                           Value="{Binding AnimationSpeed}"
                           Minimum="0.5"
                           Maximum="1.5"
                           MinimumTrackColor="{AppThemeBinding Light={StaticResource NativeAccentLight}, Dark={StaticResource NativeAccentDark}}"
                           MaximumTrackColor="{AppThemeBinding Light={StaticResource Gray300}, Dark={StaticResource Gray600}}"
                           ThumbColor="{AppThemeBinding Light={StaticResource NativeAccentLight}, Dark={StaticResource NativeAccentDark}}"
                           VerticalOptions="Center"
                           SemanticProperties.Description="{x:Static strings:AppStrings.AnimationSpeed}"
                           SemanticProperties.Hint="{x:Static strings:AppStrings.AnimationSpeedHint}" />
                        <Label
                           Grid.Column="2"
                           Text="{x:Static strings:AppStrings.AnimationSpeedFast}"
                           FontSize="13"
                           TextColor="{AppThemeBinding Light={StaticResource NativeTextSecondaryLight}, Dark={StaticResource NativeTextSecondaryDark}}"
                           VerticalOptions="Center" />
                     </Grid>

                     <Label
                        Text="{Binding AnimationSpeed, StringFormat='{0:F1}x'}"
                        FontSize="15"
                        FontAttributes="Bold"
                        TextColor="{AppThemeBinding Light={StaticResource NativeTextPrimaryLight}, Dark={StaticResource NativeTextPrimaryDark}}"
                        HorizontalOptions="Center"
                        Margin="0,4,0,0" />
                  </VerticalStackLayout>
               </VerticalStackLayout>
            </Border>
         </VerticalStackLayout>

         <!-- Haptics Section (conditionally visible) -->
         <VerticalStackLayout Spacing="8" IsVisible="{Binding IsHapticsSupported}">
            <Label x:Name="HapticsSectionLabel"
               Text="{x:Static strings:AppStrings.HapticsSection}"
               FontSize="13"
               TextColor="{AppThemeBinding Light={StaticResource NativeTextTertiaryLight}, Dark={StaticResource NativeTextTertiaryDark}}"
               Margin="16,0,0,0" />
            
            <Border x:Name="HapticsSectionBorder"
               Background="{AppThemeBinding Light={StaticResource NativeSettingsCellBackgroundLight}, Dark={StaticResource NativeSettingsCellBackgroundDark}}"
               Stroke="Transparent">
               <Border.StrokeShape>
                  <RoundRectangle CornerRadius="{StaticResource NativeCardCornerRadius}" />
               </Border.StrokeShape>
               <Grid x:Name="HapticsToggleGrid"
                     ColumnDefinitions="*,Auto"
                     ColumnSpacing="16"
                     Padding="16,12">
                  <Label x:Name="EnableHapticsLabel"
                     Grid.Column="0"
                     Text="{x:Static strings:AppStrings.EnableHaptics}"
                     FontSize="17"
                     TextColor="{AppThemeBinding Light={StaticResource NativeTextPrimaryLight}, Dark={StaticResource NativeTextPrimaryDark}}"
                     VerticalOptions="Center" />
                  <Switch x:Name="HapticsEnabledSwitch"
                     AutomationId="HapticsEnabledSwitch"
                     Grid.Column="1"
                     IsToggled="{Binding HapticsEnabled}"
                     OnColor="{AppThemeBinding Light={StaticResource NativeAccentLight}, Dark={StaticResource NativeAccentDark}}"
                     ThumbColor="White"
                     VerticalOptions="Center"
                     SemanticProperties.Description="{x:Static strings:AppStrings.EnableHaptics}"
                     SemanticProperties.Hint="{x:Static strings:AppStrings.EnableHapticsHint}" />
               </Grid>
            </Border>
         </VerticalStackLayout>

      </VerticalStackLayout>
   </ScrollView>
</ContentPage>
